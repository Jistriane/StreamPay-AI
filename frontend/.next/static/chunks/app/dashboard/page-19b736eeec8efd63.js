(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{8364:function(e,t,s){Promise.resolve().then(s.bind(s,5016))},1525:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}}),s(2265);var a=s(7437);function n(e){let{children:t,variant:s="primary",size:n="md",fullWidth:r=!1,loading:l=!1,icon:c,className:i="",disabled:o,...d}=e;return(0,a.jsxs)("button",{className:"btn ".concat({primary:"btn-primary",secondary:"btn-secondary",danger:"btn-danger",ghost:"btn-ghost",neon:"btn-neon"}[s]," ").concat({sm:"btn-sm",md:"btn-md",lg:"btn-lg"}[n]," ").concat(r?"btn-full":""," ").concat(l?"btn-loading":""," ").concat(i),disabled:o||l,...d,children:[l&&(0,a.jsx)("span",{className:"btn-spinner"}),c&&!l&&(0,a.jsx)("span",{className:"btn-icon",children:c}),(0,a.jsx)("span",{children:t})]})}},2711:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}}),s(2265);var a=s(7437);function n(e){let{children:t,className:s="",variant:n="default",hover:r=!1,padding:l="md"}=e;return(0,a.jsx)("div",{className:"card ".concat({default:"card-default",glass:"card-glass",gradient:"card-gradient",bordered:"card-bordered"}[n]," ").concat({sm:"p-4",md:"p-6",lg:"p-8"}[l]," ").concat(r?"card-hover":""," ").concat(s),children:t})}},5016:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return x}});var a=s(2265),n=s(2921),r=s(2711),l=s(1525),c=s(5100),i=s(7437),o=s(9151);function d(e){let{isOpen:t,onClose:s,onStreamCreated:n}=e,[d,m]=(0,a.useState)({recipient:"",token:"USDC",deposit:"",rate_per_second:""}),[u,x]=(0,a.useState)(!1),[h,p]=(0,a.useState)(null),[f,j]=(0,a.useState)(!1),g=e=>{let{name:t,value:s}=e.target;m(e=>({...e,[t]:s})),p(null)},b=()=>d.recipient.trim()?/^0x[a-fA-F0-9]{40}$/.test(d.recipient)?!d.deposit||0>=parseFloat(d.deposit)?(p("Valor de dep\xf3sito deve ser maior que zero"),!1):!(!d.rate_per_second||0>=parseFloat(d.rate_per_second))||(p("Taxa por segundo deve ser maior que zero"),!1):(p("Endere\xe7o Ethereum inv\xe1lido (deve come\xe7ar com 0x)"),!1):(p("Endere\xe7o do destinat\xe1rio \xe9 obrigat\xf3rio"),!1),v=async e=>{if(e.preventDefault(),b()){x(!0),p(null),j(!1);try{let e=await (0,c.ri)("".concat(o.env.NEXT_PUBLIC_BACKEND_URL||"http://localhost:3001","/api/streams"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({recipient:d.recipient,token:d.token,deposit:d.deposit,rate_per_second:d.rate_per_second})});if(!e.ok){let t=await e.json();throw Error(t.message||"Erro ao criar stream")}j(!0),m({recipient:"",token:"USDC",deposit:"",rate_per_second:""}),setTimeout(()=>{null==n||n(),s()},2e3)}catch(e){p(e instanceof Error?e.message:"Erro desconhecido")}finally{x(!1)}}};return t?(0,i.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,i.jsxs)(r.Z,{variant:"glass",padding:"lg",className:"max-w-md w-full",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,i.jsx)("h2",{className:"text-2xl font-bold",children:"Criar Novo Stream"}),(0,i.jsx)("button",{onClick:s,className:"text-secondary hover:text-white text-2xl",disabled:u,children:"✕"})]}),f?(0,i.jsxs)("div",{className:"text-center py-8",children:[(0,i.jsx)("p",{className:"text-4xl mb-4",children:"✅"}),(0,i.jsx)("p",{className:"text-green-400 font-bold mb-2",children:"Stream criado com sucesso!"}),(0,i.jsx)("p",{className:"text-secondary text-sm",children:"Redirecionando..."})]}):(0,i.jsxs)("form",{onSubmit:v,className:"space-y-4",children:[h&&(0,i.jsx)("div",{className:"bg-red-500/20 border border-red-500/50 rounded p-3",children:(0,i.jsxs)("p",{className:"text-red-400 text-sm",children:["❌ ",h]})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm text-secondary mb-2",children:"Endere\xe7o do Destinat\xe1rio"}),(0,i.jsx)("input",{type:"text",name:"recipient",value:d.recipient,onChange:g,placeholder:"0x...",className:"w-full bg-slate-800/50 border border-slate-700 rounded px-4 py-2 text-white placeholder-secondary focus:outline-none focus:border-cyan-400 font-mono text-sm",disabled:u}),(0,i.jsx)("p",{className:"text-xs text-secondary mt-1",children:"Endere\xe7o Ethereum de 42 caracteres"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm text-secondary mb-2",children:"Token"}),(0,i.jsxs)("select",{name:"token",value:d.token,onChange:g,className:"w-full bg-slate-800/50 border border-slate-700 rounded px-4 py-2 text-white focus:outline-none focus:border-cyan-400",disabled:u,children:[(0,i.jsx)("option",{value:"USDC",children:"USDC"}),(0,i.jsx)("option",{value:"USDT",children:"USDT"}),(0,i.jsx)("option",{value:"ETH",children:"ETH"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("label",{className:"block text-sm text-secondary mb-2",children:["Valor de Dep\xf3sito (",d.token,")"]}),(0,i.jsx)("input",{type:"number",name:"deposit",value:d.deposit,onChange:g,placeholder:"100.00",step:"0.01",className:"w-full bg-slate-800/50 border border-slate-700 rounded px-4 py-2 text-white placeholder-secondary focus:outline-none focus:border-cyan-400",disabled:u})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("label",{className:"block text-sm text-secondary mb-2",children:["Taxa por Segundo (",d.token,")"]}),(0,i.jsx)("input",{type:"number",name:"rate_per_second",value:d.rate_per_second,onChange:g,placeholder:"0.01",step:"0.0001",className:"w-full bg-slate-800/50 border border-slate-700 rounded px-4 py-2 text-white placeholder-secondary focus:outline-none focus:border-cyan-400",disabled:u}),d.rate_per_second&&(0,i.jsxs)("div",{className:"mt-2 p-3 bg-slate-800/50 rounded text-sm",children:[(0,i.jsx)("p",{className:"text-secondary mb-1",children:"Estimativa mensal:"}),(0,i.jsxs)("p",{className:"text-cyan-400 font-bold",children:[(2592e3*(parseFloat(d.rate_per_second)||0)).toFixed(2)," ",d.token]})]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-3 pt-4",children:[(0,i.jsx)(l.Z,{variant:"ghost",onClick:s,disabled:u,fullWidth:!0,children:"Cancelar"}),(0,i.jsx)(l.Z,{variant:"neon",type:"submit",disabled:u,fullWidth:!0,children:u?"⏳ Criando...":"✓ Criar"})]})]})]})}):null}var m=s(3491),u=s(9151);function x(){let e=(0,n.useRouter)(),{isAuthenticated:t,loading:s,user:o,address:x,logout:h}=(0,m.a)(),[p,f]=(0,a.useState)([]),[j,g]=(0,a.useState)(!1),[b,v]=(0,a.useState)(null),[N,y]=(0,a.useState)(!1);(0,a.useEffect)(()=>{s||t||e.push("/login")},[t,s,e]),(0,a.useEffect)(()=>{t&&x&&S()},[t,x]);let S=async()=>{g(!0),v(null);try{let e=await (0,c.ri)("".concat(u.env.NEXT_PUBLIC_BACKEND_URL||"http://localhost:3001","/api/streams"));if(!e.ok)throw Error("Falha ao buscar streams");let t=await e.json();f(t.data||[])}catch(e){console.error("Erro ao buscar streams:",e),v(e instanceof Error?e.message:"Erro desconhecido"),f([])}finally{g(!1)}};if(s)return(0,i.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,i.jsx)(r.Z,{variant:"glass",padding:"lg",children:(0,i.jsx)("p",{className:"text-center",children:"Carregando..."})})});if(!t)return null;let k=p.filter(e=>"active"===e.status||"pending"===e.status),w=p.filter(e=>"completed"===e.status||"cancelled"===e.status),T=k.reduce((e,t)=>{let s=parseFloat(t.deposit||"0");return e+(isNaN(s)?0:s)},0);return(0,i.jsxs)("div",{className:"min-h-screen py-8",children:[(0,i.jsxs)("div",{className:"max-w-6xl mx-auto px-4",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{className:"text-4xl font-bold text-gradient mb-2",children:"Dashboard"}),(0,i.jsx)("p",{className:"text-secondary",children:"Bem-vindo ao StreamPay AI"})]}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsx)(l.Z,{onClick:()=>y(!0),variant:"neon",children:"✨ Criar Stream"}),(0,i.jsx)(l.Z,{onClick:h,variant:"ghost",children:"Desconectar"})]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[(0,i.jsxs)(r.Z,{variant:"glass",padding:"lg",children:[(0,i.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Informa\xe7\xf5es da Conta"}),(0,i.jsxs)("div",{className:"space-y-3",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-sm text-secondary",children:"Carteira:"}),(0,i.jsx)("p",{className:"font-mono text-lg",children:x?"".concat(x.slice(0,6),"...").concat(x.slice(-4)):"N\xe3o conectada"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-sm text-secondary",children:"Email:"}),(0,i.jsx)("p",{className:"font-mono text-sm",children:(null==o?void 0:o.email)||"Carregando..."})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-sm text-secondary",children:"Fun\xe7\xe3o:"}),(0,i.jsx)("p",{className:"capitalize",children:(null==o?void 0:o.role)||"Carregando..."})]})]})]}),(0,i.jsxs)(r.Z,{variant:"glass",padding:"lg",children:[(0,i.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Estat\xedsticas"}),(0,i.jsxs)("div",{className:"space-y-3",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-sm text-secondary",children:"Streams Ativas:"}),(0,i.jsx)("p",{className:"text-2xl font-bold text-gradient",children:k.length})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-sm text-secondary",children:"Total Depositado:"}),(0,i.jsxs)("p",{className:"text-2xl font-bold",children:["$",T.toFixed(2)]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-sm text-secondary",children:"Status:"}),(0,i.jsx)("p",{className:"text-green-500",children:"✅ Ativa"})]})]})]})]}),(0,i.jsxs)(r.Z,{variant:"glass",padding:"lg",className:"mb-8",children:[(0,i.jsxs)("h2",{className:"text-2xl font-bold mb-6",children:["Streams Ativos (",k.length,")"]}),j?(0,i.jsx)("div",{className:"text-center py-8",children:(0,i.jsx)("p",{className:"text-secondary",children:"Carregando streams..."})}):b?(0,i.jsxs)("div",{className:"bg-red-500/10 border border-red-500 rounded p-4 mb-4",children:[(0,i.jsxs)("p",{className:"text-red-400",children:["⚠️ Erro: ",b]}),(0,i.jsx)(l.Z,{onClick:S,variant:"ghost",className:"mt-2",children:"Tentar Novamente"})]}):0===k.length?(0,i.jsxs)("div",{className:"text-center py-12",children:[(0,i.jsx)("p",{className:"text-secondary mb-4",children:"Nenhum stream ativo no momento"}),(0,i.jsx)(l.Z,{variant:"neon",onClick:()=>e.push("/streams"),children:"Criar Stream"})]}):(0,i.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:k.map(e=>(0,i.jsxs)("div",{className:"bg-gradient-to-br from-slate-800/50 to-blue-900/50 rounded-lg p-4 border border-cyan-500/30",children:[(0,i.jsxs)("div",{className:"mb-3",children:[(0,i.jsxs)("p",{className:"text-xs text-cyan-400 uppercase tracking-wider",children:["Stream ",e.id]}),(0,i.jsxs)("p",{className:"text-sm text-secondary mt-1",children:["Para: ","".concat(String(e.recipient).slice(0,6),"...").concat(String(e.recipient).slice(-4))]})]}),(0,i.jsxs)("div",{className:"space-y-2 text-sm mb-4",children:[(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)("span",{className:"text-secondary",children:"Token:"}),(0,i.jsx)("span",{className:"font-semibold",children:e.token})]}),(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)("span",{className:"text-secondary",children:"Depositado:"}),(0,i.jsx)("span",{className:"font-semibold",children:e.deposit})]}),(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)("span",{className:"text-secondary",children:"Taxa/s:"}),(0,i.jsx)("span",{className:"font-semibold text-cyan-400",children:e.rate_per_second})]}),(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)("span",{className:"text-secondary",children:"Status:"}),(0,i.jsx)("span",{className:"px-2 py-0.5 rounded text-xs bg-green-500/20 text-green-400",children:e.status})]})]}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsx)(l.Z,{variant:"neon",className:"flex-1",children:"Reivindicar"}),(0,i.jsx)(l.Z,{variant:"neon",className:"flex-1",children:"Detalhes"})]})]},e.id))})]}),w.length>0&&(0,i.jsxs)(r.Z,{variant:"glass",padding:"lg",className:"mb-8",children:[(0,i.jsxs)("h2",{className:"text-2xl font-bold mb-6",children:["Hist\xf3rico (",w.length,")"]}),(0,i.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:w.map(e=>(0,i.jsxs)("div",{className:"bg-slate-800/30 rounded-lg p-4 border border-slate-700",children:[(0,i.jsxs)("div",{className:"mb-3",children:[(0,i.jsxs)("p",{className:"text-xs text-slate-400 uppercase tracking-wider",children:["Stream ",e.id]}),(0,i.jsxs)("p",{className:"text-sm text-secondary mt-1",children:["Para: ","".concat(String(e.recipient).slice(0,6),"...").concat(String(e.recipient).slice(-4))]})]}),(0,i.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)("span",{className:"text-secondary",children:"Token:"}),(0,i.jsx)("span",{className:"font-semibold",children:e.token})]}),(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)("span",{className:"text-secondary",children:"Total:"}),(0,i.jsx)("span",{className:"font-semibold",children:e.deposit})]}),(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)("span",{className:"text-secondary",children:"Status:"}),(0,i.jsx)("span",{className:"px-2 py-0.5 rounded text-xs bg-slate-700 text-slate-300",children:e.status})]})]})]},e.id))})]}),(0,i.jsxs)(r.Z,{variant:"glass",padding:"lg",children:[(0,i.jsx)("h2",{className:"text-xl font-bold mb-4",children:"A\xe7\xf5es Dispon\xedveis"}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,i.jsx)(l.Z,{variant:"neon",fullWidth:!0,onClick:()=>e.push("/streams"),children:"Criar Stream"}),(0,i.jsx)(l.Z,{variant:"neon",fullWidth:!0,onClick:S,children:"Atualizar"}),(0,i.jsx)(l.Z,{variant:"neon",fullWidth:!0,onClick:()=>e.push("/historico"),children:"Hist\xf3rico Completo"})]})]})]}),(0,i.jsx)(d,{isOpen:N,onClose:()=>y(!1),onStreamCreated:S})]})}},3491:function(e,t,s){"use strict";s.d(t,{a:function(){return n}});var a=s(2265);function n(){let[e,t]=(0,a.useState)(null),[s,n]=(0,a.useState)(null),[r,l]=(0,a.useState)(null),[c,i]=(0,a.useState)(!0),o=async()=>{let e=localStorage.getItem("authToken");if(!e){i(!1);return}try{let t=await fetch("http://localhost:3001/api/auth/me",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();l(e)}else d()}catch(e){console.error("Erro ao carregar dados do usu\xe1rio:",e)}finally{i(!1)}};(0,a.useEffect)(()=>{let e=localStorage.getItem("authToken");localStorage.getItem("refreshToken");let s=localStorage.getItem("userAddress");e&&s&&(t(e),n(s)),o()},[]);let d=()=>{localStorage.removeItem("authToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("userAddress"),t(null),n(null),l(null)};return{token:e,address:s,user:r,isAuthenticated:!!e,loading:c,logout:d,refreshUser:o}}},5100:function(e,t,s){"use strict";async function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=localStorage.getItem("authToken"),a=localStorage.getItem("refreshToken"),n=new Headers({"Content-Type":"application/json",...t.headers});s&&n.set("Authorization","Bearer ".concat(s));let r=await fetch("http://localhost:3001/api".concat(e),{...t,headers:n});if(401===r.status){if(a)try{let s=await fetch("http://localhost:3001/api/auth/refresh",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:a})});if(s.ok){let a=(await s.json()).token;a&&(localStorage.setItem("authToken",a),n.set("Authorization","Bearer ".concat(a)),r=await fetch("http://localhost:3001/api".concat(e),{...t,headers:n}))}}catch(e){}401===r.status&&(localStorage.removeItem("authToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("userAddress"),window.location.href="/login")}return r}s.d(t,{ri:function(){return a}})},2921:function(e,t,s){"use strict";var a=s(6168);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}})},9151:function(e,t,s){"use strict";var a,n;e.exports=(null==(a=s.g.process)?void 0:a.env)&&"object"==typeof(null==(n=s.g.process)?void 0:n.env)?s.g.process:s(7429)},7429:function(e){"use strict";!function(){var t={229:function(e){var t,s,a,n=e.exports={};function r(){throw Error("setTimeout has not been defined")}function l(){throw Error("clearTimeout has not been defined")}function c(e){if(t===setTimeout)return setTimeout(e,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(s){try{return t.call(null,e,0)}catch(s){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(e){t=r}try{s="function"==typeof clearTimeout?clearTimeout:l}catch(e){s=l}}();var i=[],o=!1,d=-1;function m(){o&&a&&(o=!1,a.length?i=a.concat(i):d=-1,i.length&&u())}function u(){if(!o){var e=c(m);o=!0;for(var t=i.length;t;){for(a=i,i=[];++d<t;)a&&a[d].run();d=-1,t=i.length}a=null,o=!1,function(e){if(s===clearTimeout)return clearTimeout(e);if((s===l||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(e);try{s(e)}catch(t){try{return s.call(null,e)}catch(t){return s.call(this,e)}}}(e)}}function x(e,t){this.fun=e,this.array=t}function h(){}n.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var s=1;s<arguments.length;s++)t[s-1]=arguments[s];i.push(new x(e,t)),1!==i.length||o||c(u)},x.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=h,n.addListener=h,n.once=h,n.off=h,n.removeListener=h,n.removeAllListeners=h,n.emit=h,n.prependListener=h,n.prependOnceListener=h,n.listeners=function(e){return[]},n.binding=function(e){throw Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw Error("process.chdir is not supported")},n.umask=function(){return 0}}},s={};function a(e){var n=s[e];if(void 0!==n)return n.exports;var r=s[e]={exports:{}},l=!0;try{t[e](r,r.exports,a),l=!1}finally{l&&delete s[e]}return r.exports}a.ab="//";var n=a(229);e.exports=n}()}},function(e){e.O(0,[971,529,744],function(){return e(e.s=8364)}),_N_E=e.O()}]);