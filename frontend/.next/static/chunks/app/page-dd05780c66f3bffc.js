(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{6933:function(e,s,a){Promise.resolve().then(a.bind(a,8841))},8841:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return o}});var t=a(2265),n=a(4167),i=a(7437);function r(){let{address:e,isConnected:s}=(0,n.mA)(),[a,r]=(0,t.useState)([{id:"1",role:"assistant",content:"Ol\xe1! Sou o assistente IA do StreamPay. Como posso ajud\xe1-lo hoje?",timestamp:new Date}]),[o,c]=(0,t.useState)(""),[l,d]=(0,t.useState)(!1),m=(0,t.useRef)(null),u=(0,t.useRef)(null),h=()=>{var e;null===(e=m.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})};(0,t.useEffect)(()=>{h()},[a]);let p=async()=>{if(!o.trim()||l)return;let a={id:Date.now().toString(),role:"user",content:o.trim(),timestamp:new Date};r(e=>[...e,a]),c(""),d(!0);try{let t=await fetch("/api/eliza",{method:"POST",headers:{"Content-Type":"application/json",...s&&e?{authorization:"".concat(e,":123")}:{}},body:JSON.stringify({prompt:a.content,userAddress:e||void 0})}),n=await t.json();if("payment"===n.type){let e="processing-".concat(Date.now()),s={id:e,role:"assistant",content:"â³ Processando transa\xe7\xe3o na blockchain...",timestamp:new Date};r(e=>[...e,s]),await new Promise(e=>setTimeout(e,2e3)),r(s=>{let a=s.filter(s=>s.id!==e),t={id:(Date.now()+1).toString(),role:"assistant",content:n.resposta||n.message||n.error||"Transa\xe7\xe3o processada com sucesso!",timestamp:new Date};return[...a,t]})}else{let e={id:(Date.now()+1).toString(),role:"assistant",content:n.resposta||n.message||n.error||"Desculpe, n\xe3o consegui processar sua mensagem.",timestamp:new Date};r(s=>[...s,e])}}catch(s){let e={id:(Date.now()+1).toString(),role:"assistant",content:"Erro: ".concat(s.message||"Falha ao conectar com o servidor."),timestamp:new Date};r(s=>[...s,e])}finally{var t;d(!1),null===(t=u.current)||void 0===t||t.focus()}};return(0,i.jsxs)("div",{className:"chat-container",children:[(0,i.jsxs)("div",{className:"chat-messages",children:[a.map(e=>(0,i.jsx)("div",{className:"chat-message ".concat("user"===e.role?"message-user":"message-assistant"),children:(0,i.jsxs)("div",{className:"message-content",children:[(0,i.jsx)("div",{className:"message-role",children:"user"===e.role?"Voc\xea":"StreamPay AI"}),(0,i.jsx)("div",{className:"message-text",children:e.content})]})},e.id)),l&&(0,i.jsx)("div",{className:"chat-message message-assistant",children:(0,i.jsxs)("div",{className:"message-content",children:[(0,i.jsx)("div",{className:"message-role",children:"StreamPay AI"}),(0,i.jsxs)("div",{className:"message-text loading-dots",children:[(0,i.jsx)("span",{}),(0,i.jsx)("span",{}),(0,i.jsx)("span",{})]})]})}),(0,i.jsx)("div",{ref:m})]}),(0,i.jsxs)("div",{className:"chat-input-container",children:[!s&&(0,i.jsx)("div",{className:"chat-warning",children:"Conecte sua wallet para usar todas as funcionalidades"}),(0,i.jsxs)("div",{className:"chat-input-wrapper",children:[(0,i.jsx)("textarea",{ref:u,value:o,onChange:e=>c(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),p())},placeholder:"Digite sua mensagem... (Enter para enviar, Shift+Enter para nova linha)",className:"chat-input",rows:1,disabled:l}),(0,i.jsx)("button",{onClick:p,"aria-label":"Enviar mensagem",disabled:!o.trim()||l,className:"chat-send-button",children:(0,i.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,i.jsx)("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),(0,i.jsx)("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]})}function o(){let[e,s]=(0,t.useState)(!1);return((0,t.useEffect)(()=>{s(!0)},[]),e)?(0,i.jsx)("div",{className:"chat-page",children:(0,i.jsx)(r,{})}):(0,i.jsx)("div",{className:"min-h-screen"})}}},function(e){e.O(0,[167,971,529,744],function(){return e(e.s=6933)}),_N_E=e.O()}]);